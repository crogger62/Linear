# Test Plan: LES-155 - Provide enumeration of issues

## Overview
Validate that the `myIssues.ts` CLI enumerates issues assigned to the
authenticated user, emitting stable, sequential numbering and correct
formatting across pagination.

## In scope
- `src/myIssues.ts` CLI output
- Issue enumeration numbering (1..N)
- Pagination handling and total count accuracy
- Output formatting with identifier/title/state fallbacks

## Out of scope
- Counts by state (`src/myIssueCounts.ts`)
- Filtered enumeration (`src/issuesFiltered.ts`)
- Picker UI and server endpoints
- Customer request export/analyzer flow

## Preconditions / test data
- Node.js 18+ (20+ preferred)
- `LINEAR_API_KEY` in `.env`
- Workspace seeded with:
  - At least 2 issues assigned to the viewer
  - At least 1 issue with a missing or empty title
  - At least 1 issue with a missing/unresolvable state
  - (Optional) > 50 assigned issues to exercise pagination
  - (Optional) archived issues assigned to the viewer

## Functional test cases
| ID | Scenario | Steps | Expected |
|----|----------|-------|----------|
| F1 | Basic enumeration | Run `npx ts-node src/myIssues.ts` | Output includes viewer line, "Issues assigned to you:", and each issue is prefixed with `1.`, `2.`, ... |
| F2 | Sequential numbering across pages | Use a user with > 50 assigned issues and run the script | Numbering continues sequentially across pages (no resets or duplicates) and the final index equals the total count |
| F3 | Issue format | Inspect any issue with complete data | Line format includes identifier, title, and `[State]` suffix (e.g., `12. ENG-123 Fix login [In Progress]`) |
| F4 | Total count | Compare printed total to number of lines | `Total issues: N` matches the number of enumerated lines |
| F5 | Archived inclusion | Use an org with archived issues assigned to viewer | Archived issues appear in output (no archived filter applied) |

## Edge cases
- **No assigned issues**: Output should show zero enumerated lines and `Total issues: 0`.
- **Missing title**: Output uses `<untitled>` without crashing.
- **Missing identifier**: Output uses `<no-id>` without crashing.
- **Missing or failed state relation**: Output uses `(No State)`.
- **Long titles**: Output prints full line without truncation or wrapping errors.

## Error scenarios
- **Missing API key**: Unset `LINEAR_API_KEY` and run the script; it fails fast with a clear error.
- **Invalid/expired API key**: Script exits non-zero and prints auth error from Linear SDK.
- **Network failure**: Simulate offline or DNS failure; script exits non-zero and surfaces the error.
- **No global fetch**: On older Node, running without the `cross-fetch` polyfill yields a fetch error; verify the commented instructions resolve it.

## Integration points
- Linear SDK: `client.viewer`, `client.issues`, `issue.state`
- dotenv `.env` loading for `LINEAR_API_KEY`
- CLI invocation via `ts-node`

## Performance considerations
- With 1k+ assigned issues, the script should complete within a few minutes
  and maintain sequential numbering without duplication.
- Output size grows linearly with issue count; confirm terminal remains responsive.
